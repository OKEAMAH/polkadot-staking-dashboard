var Ne=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ge=Math.ceil,J=Math.floor,$="[BigNumber Error] ",de=$+"Number primitive has more than 15 significant digits: ",j=1e14,E=14,we=9007199254740991,me=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],ie=1e7,C=1e9;function Ee(g){var m,v,A,p=h.prototype={constructor:h,toString:null,valueOf:null},_=new h(1),S=20,x=4,I=-7,P=21,q=-1e7,B=1e7,U=!1,K=1,R=0,V={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},D="0123456789abcdefghijklmnopqrstuvwxyz",H=!0;function h(e,r){var i,l,t,o,c,n,s,u,f=this;if(!(f instanceof h))return new h(e,r);if(r==null){if(e&&e._isBigNumber===!0){f.s=e.s,!e.c||e.e>B?f.c=f.e=null:e.e<q?f.c=[f.e=0]:(f.e=e.e,f.c=e.c.slice());return}if((n=typeof e=="number")&&e*0==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(o=0,c=e;c>=10;c/=10,o++);o>B?f.c=f.e=null:(f.e=o,f.c=[e]);return}u=String(e)}else{if(!Ne.test(u=String(e)))return A(f,u,n);f.s=u.charCodeAt(0)==45?(u=u.slice(1),-1):1}(o=u.indexOf("."))>-1&&(u=u.replace(".","")),(c=u.search(/e/i))>0?(o<0&&(o=c),o+=+u.slice(c+1),u=u.substring(0,c)):o<0&&(o=u.length)}else{if(y(r,2,D.length,"Base"),r==10&&H)return f=new h(e),W(f,S+f.e+1,x);if(u=String(e),n=typeof e=="number"){if(e*0!=0)return A(f,u,n,r);if(f.s=1/e<0?(u=u.slice(1),-1):1,h.DEBUG&&u.replace(/^0\.0*|\./,"").length>15)throw Error(de+e)}else f.s=u.charCodeAt(0)===45?(u=u.slice(1),-1):1;for(i=D.slice(0,r),o=c=0,s=u.length;c<s;c++)if(i.indexOf(l=u.charAt(c))<0){if(l=="."){if(c>o){o=s;continue}}else if(!t&&(u==u.toUpperCase()&&(u=u.toLowerCase())||u==u.toLowerCase()&&(u=u.toUpperCase()))){t=!0,c=-1,o=0;continue}return A(f,String(e),n,r)}n=!1,u=v(u,r,10,f.s),(o=u.indexOf("."))>-1?u=u.replace(".",""):o=u.length}for(c=0;u.charCodeAt(c)===48;c++);for(s=u.length;u.charCodeAt(--s)===48;);if(u=u.slice(c,++s)){if(s-=c,n&&h.DEBUG&&s>15&&(e>we||e!==J(e)))throw Error(de+f.s*e);if((o=o-c-1)>B)f.c=f.e=null;else if(o<q)f.c=[f.e=0];else{if(f.e=o,f.c=[],c=(o+1)%E,o<0&&(c+=E),c<s){for(c&&f.c.push(+u.slice(0,c)),s-=E;c<s;)f.c.push(+u.slice(c,c+=E));c=E-(u=u.slice(c)).length}else c-=s;for(;c--;u+="0");f.c.push(+u)}}else f.c=[f.e=0]}h.clone=Ee,h.ROUND_UP=0,h.ROUND_DOWN=1,h.ROUND_CEIL=2,h.ROUND_FLOOR=3,h.ROUND_HALF_UP=4,h.ROUND_HALF_DOWN=5,h.ROUND_HALF_EVEN=6,h.ROUND_HALF_CEIL=7,h.ROUND_HALF_FLOOR=8,h.EUCLID=9,h.config=h.set=function(e){var r,i;if(e!=null)if(typeof e=="object"){if(e.hasOwnProperty(r="DECIMAL_PLACES")&&(i=e[r],y(i,0,C,r),S=i),e.hasOwnProperty(r="ROUNDING_MODE")&&(i=e[r],y(i,0,8,r),x=i),e.hasOwnProperty(r="EXPONENTIAL_AT")&&(i=e[r],i&&i.pop?(y(i[0],-C,0,r),y(i[1],0,C,r),I=i[0],P=i[1]):(y(i,-C,C,r),I=-(P=i<0?-i:i))),e.hasOwnProperty(r="RANGE"))if(i=e[r],i&&i.pop)y(i[0],-C,-1,r),y(i[1],1,C,r),q=i[0],B=i[1];else if(y(i,-C,C,r),i)q=-(B=i<0?-i:i);else throw Error($+r+" cannot be zero: "+i);if(e.hasOwnProperty(r="CRYPTO"))if(i=e[r],i===!!i)if(i)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))U=i;else throw U=!i,Error($+"crypto unavailable");else U=i;else throw Error($+r+" not true or false: "+i);if(e.hasOwnProperty(r="MODULO_MODE")&&(i=e[r],y(i,0,9,r),K=i),e.hasOwnProperty(r="POW_PRECISION")&&(i=e[r],y(i,0,C,r),R=i),e.hasOwnProperty(r="FORMAT"))if(i=e[r],typeof i=="object")V=i;else throw Error($+r+" not an object: "+i);if(e.hasOwnProperty(r="ALPHABET"))if(i=e[r],typeof i=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(i))H=i.slice(0,10)=="0123456789",D=i;else throw Error($+r+" invalid: "+i)}else throw Error($+"Object expected: "+e);return{DECIMAL_PLACES:S,ROUNDING_MODE:x,EXPONENTIAL_AT:[I,P],RANGE:[q,B],CRYPTO:U,MODULO_MODE:K,POW_PRECISION:R,FORMAT:V,ALPHABET:D}},h.isBigNumber=function(e){if(!e||e._isBigNumber!==!0)return!1;if(!h.DEBUG)return!0;var r,i,l=e.c,t=e.e,o=e.s;e:if({}.toString.call(l)=="[object Array]"){if((o===1||o===-1)&&t>=-C&&t<=C&&t===J(t)){if(l[0]===0){if(t===0&&l.length===1)return!0;break e}if(r=(t+1)%E,r<1&&(r+=E),String(l[0]).length==r){for(r=0;r<l.length;r++)if(i=l[r],i<0||i>=j||i!==J(i))break e;if(i!==0)return!0}}}else if(l===null&&t===null&&(o===null||o===1||o===-1))return!0;throw Error($+"Invalid BigNumber: "+e)},h.maximum=h.max=function(){return le(arguments,-1)},h.minimum=h.min=function(){return le(arguments,1)},h.random=function(){var e=9007199254740992,r=Math.random()*e&2097151?function(){return J(Math.random()*e)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(i){var l,t,o,c,n,s=0,u=[],f=new h(_);if(i==null?i=S:y(i,0,C),c=ge(i/E),U)if(crypto.getRandomValues){for(l=crypto.getRandomValues(new Uint32Array(c*=2));s<c;)n=l[s]*131072+(l[s+1]>>>11),n>=9e15?(t=crypto.getRandomValues(new Uint32Array(2)),l[s]=t[0],l[s+1]=t[1]):(u.push(n%1e14),s+=2);s=c/2}else if(crypto.randomBytes){for(l=crypto.randomBytes(c*=7);s<c;)n=(l[s]&31)*281474976710656+l[s+1]*1099511627776+l[s+2]*4294967296+l[s+3]*16777216+(l[s+4]<<16)+(l[s+5]<<8)+l[s+6],n>=9e15?crypto.randomBytes(7).copy(l,s):(u.push(n%1e14),s+=7);s=c/7}else throw U=!1,Error($+"crypto unavailable");if(!U)for(;s<c;)n=r(),n<9e15&&(u[s++]=n%1e14);for(c=u[--s],i%=E,c&&i&&(n=me[E-i],u[s]=J(c/n)*n);u[s]===0;u.pop(),s--);if(s<0)u=[o=0];else{for(o=-1;u[0]===0;u.splice(0,1),o-=E);for(s=1,n=u[0];n>=10;n/=10,s++);s<E&&(o-=E-s)}return f.e=o,f.c=u,f}}(),h.sum=function(){for(var e=1,r=arguments,i=new h(r[0]);e<r.length;)i=i.plus(r[e++]);return i},v=function(){var e="0123456789";function r(i,l,t,o){for(var c,n=[0],s,u=0,f=i.length;u<f;){for(s=n.length;s--;n[s]*=l);for(n[0]+=o.indexOf(i.charAt(u++)),c=0;c<n.length;c++)n[c]>t-1&&(n[c+1]==null&&(n[c+1]=0),n[c+1]+=n[c]/t|0,n[c]%=t)}return n.reverse()}return function(i,l,t,o,c){var n,s,u,f,a,w,d,O,k=i.indexOf("."),L=S,N=x;for(k>=0&&(f=R,R=0,i=i.replace(".",""),O=new h(l),w=O.pow(i.length-k),R=f,O.c=r(re(Y(w.c),w.e,"0"),10,t,e),O.e=O.c.length),d=r(i,l,t,c?(n=D,e):(n=e,D)),u=f=d.length;d[--f]==0;d.pop());if(!d[0])return n.charAt(0);if(k<0?--u:(w.c=d,w.e=u,w.s=o,w=m(w,O,L,N,t),d=w.c,a=w.r,u=w.e),s=u+L+1,k=d[s],f=t/2,a=a||s<0||d[s+1]!=null,a=N<4?(k!=null||a)&&(N==0||N==(w.s<0?3:2)):k>f||k==f&&(N==4||a||N==6&&d[s-1]&1||N==(w.s<0?8:7)),s<1||!d[0])i=a?re(n.charAt(1),-L,n.charAt(0)):n.charAt(0);else{if(d.length=s,a)for(--t;++d[--s]>t;)d[s]=0,s||(++u,d=[1].concat(d));for(f=d.length;!d[--f];);for(k=0,i="";k<=f;i+=n.charAt(d[k++]));i=re(i,u,n.charAt(0))}return i}}(),m=function(){function e(l,t,o){var c,n,s,u,f=0,a=l.length,w=t%ie,d=t/ie|0;for(l=l.slice();a--;)s=l[a]%ie,u=l[a]/ie|0,c=d*s+u*w,n=w*s+c%ie*ie+f,f=(n/o|0)+(c/ie|0)+d*u,l[a]=n%o;return f&&(l=[f].concat(l)),l}function r(l,t,o,c){var n,s;if(o!=c)s=o>c?1:-1;else for(n=s=0;n<o;n++)if(l[n]!=t[n]){s=l[n]>t[n]?1:-1;break}return s}function i(l,t,o,c){for(var n=0;o--;)l[o]-=n,n=l[o]<t[o]?1:0,l[o]=n*c+l[o]-t[o];for(;!l[0]&&l.length>1;l.splice(0,1));}return function(l,t,o,c,n){var s,u,f,a,w,d,O,k,L,N,M,F,ue,he,pe,b,fe,Z=l.s==t.s?1:-1,z=l.c,T=t.c;if(!z||!z[0]||!T||!T[0])return new h(!l.s||!t.s||(z?T&&z[0]==T[0]:!T)?NaN:z&&z[0]==0||!T?Z*0:Z/0);for(k=new h(Z),L=k.c=[],u=l.e-t.e,Z=o+u+1,n||(n=j,u=Q(l.e/E)-Q(t.e/E),Z=Z/E|0),f=0;T[f]==(z[f]||0);f++);if(T[f]>(z[f]||0)&&u--,Z<0)L.push(1),a=!0;else{for(he=z.length,b=T.length,f=0,Z+=2,w=J(n/(T[0]+1)),w>1&&(T=e(T,w,n),z=e(z,w,n),b=T.length,he=z.length),ue=b,N=z.slice(0,b),M=N.length;M<b;N[M++]=0);fe=T.slice(),fe=[0].concat(fe),pe=T[0],T[1]>=n/2&&pe++;do{if(w=0,s=r(T,N,b,M),s<0){if(F=N[0],b!=M&&(F=F*n+(N[1]||0)),w=J(F/pe),w>1)for(w>=n&&(w=n-1),d=e(T,w,n),O=d.length,M=N.length;r(d,N,O,M)==1;)w--,i(d,b<O?fe:T,O,n),O=d.length,s=1;else w==0&&(s=w=1),d=T.slice(),O=d.length;if(O<M&&(d=[0].concat(d)),i(N,d,M,n),M=N.length,s==-1)for(;r(T,N,b,M)<1;)w++,i(N,b<M?fe:T,M,n),M=N.length}else s===0&&(w++,N=[0]);L[f++]=w,N[0]?N[M++]=z[ue]||0:(N=[z[ue]],M=1)}while((ue++<he||N[0]!=null)&&Z--);a=N[0]!=null,L[0]||L.splice(0,1)}if(n==j){for(f=1,Z=L[0];Z>=10;Z/=10,f++);W(k,o+(k.e=f+u*E-1)+1,c,a)}else k.e=u,k.r=+a;return k}}();function ne(e,r,i,l){var t,o,c,n,s;if(i==null?i=x:y(i,0,8),!e.c)return e.toString();if(t=e.c[0],c=e.e,r==null)s=Y(e.c),s=l==1||l==2&&(c<=I||c>=P)?ae(s,c):re(s,c,"0");else if(e=W(new h(e),r,i),o=e.e,s=Y(e.c),n=s.length,l==1||l==2&&(r<=o||o<=I)){for(;n<r;s+="0",n++);s=ae(s,o)}else if(r-=c,s=re(s,o,"0"),o+1>n){if(--r>0)for(s+=".";r--;s+="0");}else if(r+=o-n,r>0)for(o+1==n&&(s+=".");r--;s+="0");return e.s<0&&t?"-"+s:s}function le(e,r){for(var i,l,t=1,o=new h(e[0]);t<e.length;t++)l=new h(e[t]),(!l.s||(i=te(o,l))===r||i===0&&o.s===r)&&(o=l);return o}function oe(e,r,i){for(var l=1,t=r.length;!r[--t];r.pop());for(t=r[0];t>=10;t/=10,l++);return(i=l+i*E-1)>B?e.c=e.e=null:i<q?e.c=[e.e=0]:(e.e=i,e.c=r),e}A=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,r=/^([^.]+)\.$/,i=/^\.([^.]+)$/,l=/^-?(Infinity|NaN)$/,t=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(o,c,n,s){var u,f=n?c:c.replace(t,"");if(l.test(f))o.s=isNaN(f)?null:f<0?-1:1;else{if(!n&&(f=f.replace(e,function(a,w,d){return u=(d=d.toLowerCase())=="x"?16:d=="b"?2:8,!s||s==u?w:a}),s&&(u=s,f=f.replace(r,"$1").replace(i,"0.$1")),c!=f))return new h(f,u);if(h.DEBUG)throw Error($+"Not a"+(s?" base "+s:"")+" number: "+c);o.s=null}o.c=o.e=null}}();function W(e,r,i,l){var t,o,c,n,s,u,f,a=e.c,w=me;if(a){e:{for(t=1,n=a[0];n>=10;n/=10,t++);if(o=r-t,o<0)o+=E,c=r,s=a[u=0],f=J(s/w[t-c-1]%10);else if(u=ge((o+1)/E),u>=a.length)if(l){for(;a.length<=u;a.push(0));s=f=0,t=1,o%=E,c=o-E+1}else break e;else{for(s=n=a[u],t=1;n>=10;n/=10,t++);o%=E,c=o-E+t,f=c<0?0:J(s/w[t-c-1]%10)}if(l=l||r<0||a[u+1]!=null||(c<0?s:s%w[t-c-1]),l=i<4?(f||l)&&(i==0||i==(e.s<0?3:2)):f>5||f==5&&(i==4||l||i==6&&(o>0?c>0?s/w[t-c]:0:a[u-1])%10&1||i==(e.s<0?8:7)),r<1||!a[0])return a.length=0,l?(r-=e.e+1,a[0]=w[(E-r%E)%E],e.e=-r||0):a[0]=e.e=0,e;if(o==0?(a.length=u,n=1,u--):(a.length=u+1,n=w[E-o],a[u]=c>0?J(s/w[t-c]%w[c])*n:0),l)for(;;)if(u==0){for(o=1,c=a[0];c>=10;c/=10,o++);for(c=a[0]+=n,n=1;c>=10;c/=10,n++);o!=n&&(e.e++,a[0]==j&&(a[0]=1));break}else{if(a[u]+=n,a[u]!=j)break;a[u--]=0,n=1}for(o=a.length;a[--o]===0;a.pop());}e.e>B?e.c=e.e=null:e.e<q&&(e.c=[e.e=0])}return e}function ee(e){var r,i=e.e;return i===null?e.toString():(r=Y(e.c),r=i<=I||i>=P?ae(r,i):re(r,i,"0"),e.s<0?"-"+r:r)}return p.absoluteValue=p.abs=function(){var e=new h(this);return e.s<0&&(e.s=1),e},p.comparedTo=function(e,r){return te(this,new h(e,r))},p.decimalPlaces=p.dp=function(e,r){var i,l,t,o=this;if(e!=null)return y(e,0,C),r==null?r=x:y(r,0,8),W(new h(o),e+o.e+1,r);if(!(i=o.c))return null;if(l=((t=i.length-1)-Q(this.e/E))*E,t=i[t])for(;t%10==0;t/=10,l--);return l<0&&(l=0),l},p.dividedBy=p.div=function(e,r){return m(this,new h(e,r),S,x)},p.dividedToIntegerBy=p.idiv=function(e,r){return m(this,new h(e,r),0,1)},p.exponentiatedBy=p.pow=function(e,r){var i,l,t,o,c,n,s,u,f,a=this;if(e=new h(e),e.c&&!e.isInteger())throw Error($+"Exponent not an integer: "+ee(e));if(r!=null&&(r=new h(r)),n=e.e>14,!a.c||!a.c[0]||a.c[0]==1&&!a.e&&a.c.length==1||!e.c||!e.c[0])return f=new h(Math.pow(+ee(a),n?e.s*(2-ce(e)):+ee(e))),r?f.mod(r):f;if(s=e.s<0,r){if(r.c?!r.c[0]:!r.s)return new h(NaN);l=!s&&a.isInteger()&&r.isInteger(),l&&(a=a.mod(r))}else{if(e.e>9&&(a.e>0||a.e<-1||(a.e==0?a.c[0]>1||n&&a.c[1]>=24e7:a.c[0]<8e13||n&&a.c[0]<=9999975e7)))return o=a.s<0&&ce(e)?-0:0,a.e>-1&&(o=1/o),new h(s?1/o:o);R&&(o=ge(R/E+2))}for(n?(i=new h(.5),s&&(e.s=1),u=ce(e)):(t=Math.abs(+ee(e)),u=t%2),f=new h(_);;){if(u){if(f=f.times(a),!f.c)break;o?f.c.length>o&&(f.c.length=o):l&&(f=f.mod(r))}if(t){if(t=J(t/2),t===0)break;u=t%2}else if(e=e.times(i),W(e,e.e+1,1),e.e>14)u=ce(e);else{if(t=+ee(e),t===0)break;u=t%2}a=a.times(a),o?a.c&&a.c.length>o&&(a.c.length=o):l&&(a=a.mod(r))}return l?f:(s&&(f=_.div(f)),r?f.mod(r):o?W(f,R,x,c):f)},p.integerValue=function(e){var r=new h(this);return e==null?e=x:y(e,0,8),W(r,r.e+1,e)},p.isEqualTo=p.eq=function(e,r){return te(this,new h(e,r))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(e,r){return te(this,new h(e,r))>0},p.isGreaterThanOrEqualTo=p.gte=function(e,r){return(r=te(this,new h(e,r)))===1||r===0},p.isInteger=function(){return!!this.c&&Q(this.e/E)>this.c.length-2},p.isLessThan=p.lt=function(e,r){return te(this,new h(e,r))<0},p.isLessThanOrEqualTo=p.lte=function(e,r){return(r=te(this,new h(e,r)))===-1||r===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return this.s>0},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(e,r){var i,l,t,o,c=this,n=c.s;if(e=new h(e,r),r=e.s,!n||!r)return new h(NaN);if(n!=r)return e.s=-r,c.plus(e);var s=c.e/E,u=e.e/E,f=c.c,a=e.c;if(!s||!u){if(!f||!a)return f?(e.s=-r,e):new h(a?c:NaN);if(!f[0]||!a[0])return a[0]?(e.s=-r,e):new h(f[0]?c:x==3?-0:0)}if(s=Q(s),u=Q(u),f=f.slice(),n=s-u){for((o=n<0)?(n=-n,t=f):(u=s,t=a),t.reverse(),r=n;r--;t.push(0));t.reverse()}else for(l=(o=(n=f.length)<(r=a.length))?n:r,n=r=0;r<l;r++)if(f[r]!=a[r]){o=f[r]<a[r];break}if(o&&(t=f,f=a,a=t,e.s=-e.s),r=(l=a.length)-(i=f.length),r>0)for(;r--;f[i++]=0);for(r=j-1;l>n;){if(f[--l]<a[l]){for(i=l;i&&!f[--i];f[i]=r);--f[i],f[l]+=j}f[l]-=a[l]}for(;f[0]==0;f.splice(0,1),--u);return f[0]?oe(e,f,u):(e.s=x==3?-1:1,e.c=[e.e=0],e)},p.modulo=p.mod=function(e,r){var i,l,t=this;return e=new h(e,r),!t.c||!e.s||e.c&&!e.c[0]?new h(NaN):!e.c||t.c&&!t.c[0]?new h(t):(K==9?(l=e.s,e.s=1,i=m(t,e,0,3),e.s=l,i.s*=l):i=m(t,e,0,K),e=t.minus(i.times(e)),!e.c[0]&&K==1&&(e.s=t.s),e)},p.multipliedBy=p.times=function(e,r){var i,l,t,o,c,n,s,u,f,a,w,d,O,k,L,N=this,M=N.c,F=(e=new h(e,r)).c;if(!M||!F||!M[0]||!F[0])return!N.s||!e.s||M&&!M[0]&&!F||F&&!F[0]&&!M?e.c=e.e=e.s=null:(e.s*=N.s,!M||!F?e.c=e.e=null:(e.c=[0],e.e=0)),e;for(l=Q(N.e/E)+Q(e.e/E),e.s*=N.s,s=M.length,a=F.length,s<a&&(O=M,M=F,F=O,t=s,s=a,a=t),t=s+a,O=[];t--;O.push(0));for(k=j,L=ie,t=a;--t>=0;){for(i=0,w=F[t]%L,d=F[t]/L|0,c=s,o=t+c;o>t;)u=M[--c]%L,f=M[c]/L|0,n=d*u+f*w,u=w*u+n%L*L+O[o]+i,i=(u/k|0)+(n/L|0)+d*f,O[o--]=u%k;O[o]=i}return i?++l:O.splice(0,1),oe(e,O,l)},p.negated=function(){var e=new h(this);return e.s=-e.s||null,e},p.plus=function(e,r){var i,l=this,t=l.s;if(e=new h(e,r),r=e.s,!t||!r)return new h(NaN);if(t!=r)return e.s=-r,l.minus(e);var o=l.e/E,c=e.e/E,n=l.c,s=e.c;if(!o||!c){if(!n||!s)return new h(t/0);if(!n[0]||!s[0])return s[0]?e:new h(n[0]?l:t*0)}if(o=Q(o),c=Q(c),n=n.slice(),t=o-c){for(t>0?(c=o,i=s):(t=-t,i=n),i.reverse();t--;i.push(0));i.reverse()}for(t=n.length,r=s.length,t-r<0&&(i=s,s=n,n=i,r=t),t=0;r;)t=(n[--r]=n[r]+s[r]+t)/j|0,n[r]=j===n[r]?0:n[r]%j;return t&&(n=[t].concat(n),++c),oe(e,n,c)},p.precision=p.sd=function(e,r){var i,l,t,o=this;if(e!=null&&e!==!!e)return y(e,1,C),r==null?r=x:y(r,0,8),W(new h(o),e,r);if(!(i=o.c))return null;if(t=i.length-1,l=t*E+1,t=i[t]){for(;t%10==0;t/=10,l--);for(t=i[0];t>=10;t/=10,l++);}return e&&o.e+1>l&&(l=o.e+1),l},p.shiftedBy=function(e){return y(e,-we,we),this.times("1e"+e)},p.squareRoot=p.sqrt=function(){var e,r,i,l,t,o=this,c=o.c,n=o.s,s=o.e,u=S+4,f=new h("0.5");if(n!==1||!c||!c[0])return new h(!n||n<0&&(!c||c[0])?NaN:c?o:1/0);if(n=Math.sqrt(+ee(o)),n==0||n==1/0?(r=Y(c),(r.length+s)%2==0&&(r+="0"),n=Math.sqrt(+r),s=Q((s+1)/2)-(s<0||s%2),n==1/0?r="5e"+s:(r=n.toExponential(),r=r.slice(0,r.indexOf("e")+1)+s),i=new h(r)):i=new h(n+""),i.c[0]){for(s=i.e,n=s+u,n<3&&(n=0);;)if(t=i,i=f.times(t.plus(m(o,t,u,1))),Y(t.c).slice(0,n)===(r=Y(i.c)).slice(0,n))if(i.e<s&&--n,r=r.slice(n-3,n+1),r=="9999"||!l&&r=="4999"){if(!l&&(W(t,t.e+S+2,0),t.times(t).eq(o))){i=t;break}u+=4,n+=4,l=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(W(i,i.e+S+2,1),e=!i.times(i).eq(o));break}}return W(i,i.e+S+1,x,e)},p.toExponential=function(e,r){return e!=null&&(y(e,0,C),e++),ne(this,e,r,1)},p.toFixed=function(e,r){return e!=null&&(y(e,0,C),e=e+this.e+1),ne(this,e,r)},p.toFormat=function(e,r,i){var l,t=this;if(i==null)e!=null&&r&&typeof r=="object"?(i=r,r=null):e&&typeof e=="object"?(i=e,e=r=null):i=V;else if(typeof i!="object")throw Error($+"Argument not an object: "+i);if(l=t.toFixed(e,r),t.c){var o,c=l.split("."),n=+i.groupSize,s=+i.secondaryGroupSize,u=i.groupSeparator||"",f=c[0],a=c[1],w=t.s<0,d=w?f.slice(1):f,O=d.length;if(s&&(o=n,n=s,s=o,O-=o),n>0&&O>0){for(o=O%n||n,f=d.substr(0,o);o<O;o+=n)f+=u+d.substr(o,n);s>0&&(f+=u+d.slice(o)),w&&(f="-"+f)}l=a?f+(i.decimalSeparator||"")+((s=+i.fractionGroupSize)?a.replace(new RegExp("\\d{"+s+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):a):f}return(i.prefix||"")+l+(i.suffix||"")},p.toFraction=function(e){var r,i,l,t,o,c,n,s,u,f,a,w,d=this,O=d.c;if(e!=null&&(n=new h(e),!n.isInteger()&&(n.c||n.s!==1)||n.lt(_)))throw Error($+"Argument "+(n.isInteger()?"out of range: ":"not an integer: ")+ee(n));if(!O)return new h(d);for(r=new h(_),u=i=new h(_),l=s=new h(_),w=Y(O),o=r.e=w.length-d.e-1,r.c[0]=me[(c=o%E)<0?E+c:c],e=!e||n.comparedTo(r)>0?o>0?r:u:n,c=B,B=1/0,n=new h(w),s.c[0]=0;f=m(n,r,0,1),t=i.plus(f.times(l)),t.comparedTo(e)!=1;)i=l,l=t,u=s.plus(f.times(t=u)),s=t,r=n.minus(f.times(t=r)),n=t;return t=m(e.minus(i),l,0,1),s=s.plus(t.times(u)),i=i.plus(t.times(l)),s.s=u.s=d.s,o=o*2,a=m(u,l,o,x).minus(d).abs().comparedTo(m(s,i,o,x).minus(d).abs())<1?[u,l]:[s,i],B=c,a},p.toNumber=function(){return+ee(this)},p.toPrecision=function(e,r){return e!=null&&y(e,1,C),ne(this,e,r,2)},p.toString=function(e){var r,i=this,l=i.s,t=i.e;return t===null?l?(r="Infinity",l<0&&(r="-"+r)):r="NaN":(e==null?r=t<=I||t>=P?ae(Y(i.c),t):re(Y(i.c),t,"0"):e===10&&H?(i=W(new h(i),S+t+1,x),r=re(Y(i.c),i.e,"0")):(y(e,2,D.length,"Base"),r=v(re(Y(i.c),t,"0"),10,e,l,!0)),l<0&&i.c[0]&&(r="-"+r)),r},p.valueOf=p.toJSON=function(){return ee(this)},p._isBigNumber=!0,p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf,g!=null&&h.set(g),h}function Q(g){var m=g|0;return g>0||g===m?m:m-1}function Y(g){for(var m,v,A=1,p=g.length,_=g[0]+"";A<p;){for(m=g[A++]+"",v=E-m.length;v--;m="0"+m);_+=m}for(p=_.length;_.charCodeAt(--p)===48;);return _.slice(0,p+1||1)}function te(g,m){var v,A,p=g.c,_=m.c,S=g.s,x=m.s,I=g.e,P=m.e;if(!S||!x)return null;if(v=p&&!p[0],A=_&&!_[0],v||A)return v?A?0:-x:S;if(S!=x)return S;if(v=S<0,A=I==P,!p||!_)return A?0:!p^v?1:-1;if(!A)return I>P^v?1:-1;for(x=(I=p.length)<(P=_.length)?I:P,S=0;S<x;S++)if(p[S]!=_[S])return p[S]>_[S]^v?1:-1;return I==P?0:I>P^v?1:-1}function y(g,m,v,A){if(g<m||g>v||g!==J(g))throw Error($+(A||"Argument")+(typeof g=="number"?g<m||g>v?" out of range: ":" not an integer: ":" not a primitive number: ")+String(g))}function ce(g){var m=g.c.length-1;return Q(g.e/E)==m&&g.c[m]%2!=0}function ae(g,m){return(g.length>1?g.charAt(0)+"."+g.slice(1):g)+(m<0?"e":"e+")+m}function re(g,m,v){var A,p;if(m<0){for(p=v+".";++m;p+=v);g=p+g}else if(A=g.length,++m>A){for(p=v,m-=A;--m;p+=v);g+=p}else m<A&&(g=g.slice(0,m)+"."+g.slice(m));return g}var X=Ee(),se=g=>g.replace(/,/g,""),Oe=(g,m)=>new X(g.dividedBy(new X(10).exponentiatedBy(m)).toFixed(m)),G=g=>new X(10).pow(new X(g)),ve=[{value:G(24),symbol:"y",isMil:!0},{value:G(21),symbol:"z",isMil:!0},{value:G(18),symbol:"a",isMil:!0},{value:G(15),symbol:"f",isMil:!0},{value:G(12),symbol:"p",isMil:!0},{value:G(9),symbol:"n",isMil:!0},{value:G(6),symbol:"μ",isMil:!0},{value:G(3),symbol:"m",isMil:!0},{value:new X(1),symbol:""},{value:G(3),symbol:"k"},{value:G(6),symbol:"M"},{value:G(9),symbol:"G"},{value:G(12),symbol:"T"},{value:G(15),symbol:"P"},{value:G(18),symbol:"E"},{value:G(21),symbol:"Y"},{value:G(24),symbol:"Z"}];ve.map(g=>g.symbol).join(", ").replace(", ,",",");/* @license Copyright 2024 w3ux authors & contributors
SPDX-License-Identifier: GPL-3.0-only */const xe=self;xe.addEventListener("message",g=>{const{data:m}=g,{task:v}=m;let A={};switch(v){case"processExposures":A=Se(m);break;case"processEraForExposure":A=Ae(m);break}postMessage({task:v,...A})});const Ae=g=>{const{era:m,maxExposurePageSize:v,exposures:A,exitOnExposed:p,task:_,networkName:S,who:x}=g;let I=!1;const P={};return A.every(({keys:q,val:B})=>{const U=q[1],K=(B==null?void 0:B.others)??[],R=(B==null?void 0:B.own)||"0",V=(B==null?void 0:B.total)||"0",D=U===x;if(D){const h=new X(R).isZero()?"0":new X(R).dividedBy(V).toString();if(P[U]={staked:R,total:V,share:h,isValidator:D,exposedPage:1},I=!0,p)return!1}const H=K.find(h=>h.who===x);if(H){const h=K.findIndex(oe=>oe.who===x),ne=Math.floor(h/Number(v)),le=new X(H.value).isZero()||V==="0"?"0":new X(H.value).dividedBy(V).toString();if(P[U]={staked:H.value,total:V,share:le,isValidator:D,exposedPage:ne},I=!0,p)return!1}return!0}),{networkName:S,era:m,exposed:I,exposedValidators:Object.keys(P).length?P:null,task:_,who:x}},Se=g=>{const{task:m,networkName:v,era:A,units:p,exposures:_,activeAccount:S}=g,x=[];let I=0;const P=[],q=[];return _.forEach(({keys:B,val:U})=>{I++;const K=B[1];let R=(U==null?void 0:U.others.map(V=>({...V,value:se(V.value)})))??[];if(R.length){R=R.sort((D,H)=>{const h=new X(se(H.value)).minus(se(D.value));return h.isZero()?0:h.isLessThan(0)?-1:1}),x.push({address:K,others:R,own:se(U.own),total:se(U.total)});for(const D of R){const H=new X(se(D.value)),h=q.findIndex(({who:ne})=>ne===D.who);h===-1?q.push({who:D.who,value:H.toString()}):q[h].value=new X(q[h].value).plus(H).toString()}const V=R.find(({who:D})=>D===S);V!==void 0&&P.push({address:K,value:Oe(new X(se(V.value)),p).toString()})}}),{networkName:v,era:A,stakers:x,totalActiveNominators:q.length,activeAccountOwnStake:P,activeValidators:I,task:m,who:S}};
